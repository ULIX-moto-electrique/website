---
import navigation from "../data/navigation.json"
import Logo from '../assets/theme-images/logo.svg'

const { settings } = Astro.props
import { getPath } from '../utils/getPath.js'

import BurgerMenu from './BurgerMenu.astro'

const normalizePath = (path) => {
  if (!path) return '/'
  if (path === '/') return '/'
  return path.replace(/\/+$/, '') || '/'
}

const currentPath = normalizePath(Astro.url.pathname)

const navItems = navigation.map((item) => {
  const href = getPath(item.link)
  return {
    ...item,
    href,
    isActive: normalizePath(href) === currentPath,
  }
})
---

<header class="wrapper bg-loop font-semibold">

  <!-- Wrapper -->
  <div class="bs-container py-6 flex justify-between items-center">

    <!-- Logo -->
    <a class="flex xl:min-w-32 group" href={ getPath('/') } aria-label={ settings.title + ' - Home' }>

      <Logo class="group-hover:scale-80 transition-transform ease-bs-spring duration-1000" height="96" width="96" />

    </a>

    <!-- Desktop Nav + Mobile Burger -->
    <div class="col-span-6 flex items-center justify-end gap-2">

      <!-- Desktop Links (hidden on small screens) -->
      <nav class="hidden md:flex justify-end lg:gap-2 bg-neutral-500/50 rounded-md">
        { navItems.map((item) =>
          <a
            class="bs-btn before:translate-y-full hover:before:translate-y-0"
            href={ item.href }
            aria-current={ item.isActive ? 'page' : undefined }
            style={ item.isActive ? `background-color: var(--color-accent)` : `background-color: transparent` }
          >
            { item.title }
          </a>
        )}
      </nav>

      <!-- Mobile Burger Menu -->
      <BurgerMenu navigation={navItems} />

    </div>

  </div>

</header>
